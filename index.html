<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QA Automation Coverage Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }
        .sidebar {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            min-height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            z-index: 1000;
        }
        .main-content {
            margin-left: 280px;
            background: rgba(255, 255, 255, 0.1);
            min-height: 100vh;
            backdrop-filter: blur(10px);
        }
        .nav-link {
            color: white !important;
            transition: all 0.3s;
            margin: 5px 10px;
            border-radius: 10px;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            font-weight: 500;
        }
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }
        .nav-link.active {
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
        }
        .dashboard-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            padding: 25px;
            margin-bottom: 20px;
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }
        .metric-card {
            text-align: center;
            padding: 30px;
            margin: 10px;
            border-radius: 20px;
            color: white;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
        }
        .metric-card.testers {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
        }
        .metric-card.projects {
            background: linear-gradient(135deg, #45b7d1 0%, #96c93d 100%);
        }
        .metric-card.testcases {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        .metric-card.automation {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
        }
        .metric-value {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        .metric-label {
            font-size: 1.3rem;
            opacity: 0.9;
            font-weight: 500;
        }
        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .top-bar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .top-bar h1 {
            color: #333;
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }
        .top-bar p {
            color: #666;
            margin: 10px 0 0 0;
            font-size: 1.2rem;
        }
        .brand-logo {
            font-size: 2.2rem;
            font-weight: bold;
            color: white;
            text-align: center;
            padding: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 30px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        .status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .status-automated {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
        }
        .status-manual {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
        }
        .status-progress {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
        }
        .status-ready {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            color: white;
        }
        .refresh-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .refresh-btn:hover {
            transform: scale(1.1) rotate(180deg);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="brand-logo">
            <i class="fas fa-chart-line"></i> QA Dashboard
        </div>
        <nav class="nav nav-pills flex-column">
            <a class="nav-link active" href="#" onclick="showSection('dashboard')">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </a>
            <a class="nav-link" href="#" onclick="showSection('testers')">
                <i class="fas fa-users"></i> Testers
            </a>
            <a class="nav-link" href="#" onclick="showSection('projects')">
                <i class="fas fa-folder"></i> Projects
            </a>
            <a class="nav-link" href="#" onclick="showSection('testcases')">
                <i class="fas fa-clipboard-check"></i> Test Cases
            </a>
        </nav>
    </div>

    <div class="main-content">
        <div class="container-fluid p-4">
            <!-- Dashboard Section -->
            <div id="dashboard" class="content-section active">
                <div class="top-bar">
                    <h1><i class="fas fa-tachometer-alt"></i> Dashboard Overview</h1>
                    <p class="text-muted">Real-time QA automation coverage metrics</p>
                </div>

                <div class="row">
                    <div class="col-md-3">
                        <div class="metric-card testers pulse-animation">
                            <div class="metric-value" id="totalTesters">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                            <div class="metric-label">Total Testers</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card projects pulse-animation">
                            <div class="metric-value" id="totalProjects">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                            <div class="metric-label">Total Projects</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card testcases pulse-animation">
                            <div class="metric-value" id="totalTestCases">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                            <div class="metric-label">Total Test Cases</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card automation pulse-animation">
                            <div class="metric-value" id="automationPercentage">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                            <div class="metric-label">Automation Coverage</div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="dashboard-card">
                            <h4><i class="fas fa-chart-pie"></i> Test Status Distribution</h4>
                            <div class="chart-container">
                                <canvas id="statusChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="dashboard-card">
                            <h4><i class="fas fa-chart-bar"></i> Automation Progress</h4>
                            <div class="chart-container">
                                <canvas id="progressChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="dashboard-card">
                            <h4><i class="fas fa-tasks"></i> Status Summary</h4>
                            <div class="stats-grid">
                                <div class="text-center">
                                    <div class="status-badge status-automated">
                                        <i class="fas fa-robot"></i> Automated
                                        <div class="h3 mt-2" id="automatedCount">0</div>
                                    </div>
                                </div>
                                <div class="text-center">
                                    <div class="status-badge status-manual">
                                        <i class="fas fa-hand-paper"></i> Manual Testing
                                        <div class="h3 mt-2" id="manualCount">0</div>
                                    </div>
                                </div>
                                <div class="text-center">
                                    <div class="status-badge status-progress">
                                        <i class="fas fa-cog fa-spin"></i> In Progress
                                        <div class="h3 mt-2" id="inProgressCount">0</div>
                                    </div>
                                </div>
                                <div class="text-center">
                                    <div class="status-badge status-ready">
                                        <i class="fas fa-clock"></i> Ready to Automate
                                        <div class="h3 mt-2" id="readyCount">0</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Testers Section -->
            <div id="testers" class="content-section">
                <div class="top-bar">
                    <h1><i class="fas fa-users"></i> QA Testers</h1>
                    <p class="text-muted">Manage your testing team</p>
                </div>
                <div class="dashboard-card">
                    <div class="loading-spinner">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading testers...</span>
                        </div>
                    </div>
                    <p class="text-center text-muted mt-3">Coming soon - Tester management interface</p>
                </div>
            </div>

            <!-- Projects Section -->
            <div id="projects" class="content-section">
                <div class="top-bar">
                    <h1><i class="fas fa-folder"></i> Projects</h1>
                    <p class="text-muted">Manage your automation projects</p>
                </div>
                <div class="dashboard-card">
                    <div class="loading-spinner">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading projects...</span>
                        </div>
                    </div>
                    <p class="text-center text-muted mt-3">Coming soon - Project management interface</p>
                </div>
            </div>

            <!-- Test Cases Section -->
            <div id="testcases" class="content-section">
                <div class="top-bar">
                    <h1><i class="fas fa-clipboard-check"></i> Test Cases</h1>
                    <p class="text-muted">Track your test case automation status</p>
                </div>
                <div class="dashboard-card">
                    <div class="loading-spinner">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading test cases...</span>
                        </div>
                    </div>
                    <p class="text-center text-muted mt-3">Coming soon - Test case tracking interface</p>
                </div>
            </div>
        </div>
    </div>

    <button class="refresh-btn" onclick="refreshData()" title="Refresh Data">
        <i class="fas fa-sync-alt"></i>
    </button>

    <script>
        let statusChart;
        let progressChart;

        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Update navigation
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            event.target.classList.add('active');
        }

        function refreshData() {
            const refreshBtn = document.querySelector('.refresh-btn');
            refreshBtn.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i>';
            loadDashboardStats();
            setTimeout(() => {
                refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i>';
            }, 1000);
        }

        async function loadDashboardStats() {
            try {
                const response = await fetch('http://localhost:8000/api/dashboard/stats');
                const data = await response.json();
                
                // Remove pulse animation and update metric cards
                document.querySelectorAll('.metric-card').forEach(card => {
                    card.classList.remove('pulse-animation');
                });
                
                // Update metric cards with animated counting
                animateValue('totalTesters', 0, data.totalTesters, 1000);
                animateValue('totalProjects', 0, data.totalProjects, 1000);
                animateValue('totalTestCases', 0, data.totalTestCases, 1000);
                
                // Calculate automation percentage
                const automationPercentage = Math.round((data.automatedCount / data.totalTestCases) * 100);
                animateValue('automationPercentage', 0, automationPercentage, 1000, '%');
                
                // Update status counts
                animateValue('automatedCount', 0, data.automatedCount, 1000);
                animateValue('manualCount', 0, data.manualCount, 1000);
                animateValue('inProgressCount', 0, data.inProgressCount, 1000);
                animateValue('readyCount', 0, data.completedCount, 1000);
                
                // Create charts
                setTimeout(() => {
                    createStatusChart(data);
                    createProgressChart(data);
                }, 500);
                
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
                // Show error state
                document.getElementById('totalTesters').textContent = 'Error';
                document.getElementById('totalProjects').textContent = 'Error';
                document.getElementById('totalTestCases').textContent = 'Error';
                document.getElementById('automationPercentage').textContent = 'Error';
            }
        }

        function animateValue(id, start, end, duration, suffix = '') {
            const element = document.getElementById(id);
            const range = end - start;
            const increment = end > start ? 1 : -1;
            const stepTime = Math.abs(Math.floor(duration / range));
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                element.textContent = current + suffix;
                if (current == end) {
                    clearInterval(timer);
                }
            }, stepTime);
        }

        function createStatusChart(data) {
            const ctx = document.getElementById('statusChart').getContext('2d');
            
            if (statusChart) {
                statusChart.destroy();
            }
            
            statusChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Automated', 'Manual Testing', 'In Progress', 'Ready to Automate'],
                    datasets: [{
                        data: [data.automatedCount, data.manualCount, data.inProgressCount, data.completedCount],
                        backgroundColor: [
                            '#00b894',
                            '#fdcb6e',
                            '#74b9ff',
                            '#fd79a8'
                        ],
                        borderWidth: 3,
                        borderColor: '#fff',
                        hoverBorderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '50%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
        }

        function createProgressChart(data) {
            const ctx = document.getElementById('progressChart').getContext('2d');
            
            if (progressChart) {
                progressChart.destroy();
            }
            
            progressChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Automated', 'Manual Testing', 'In Progress', 'Ready to Automate'],
                    datasets: [{
                        label: 'Test Cases',
                        data: [data.automatedCount, data.manualCount, data.inProgressCount, data.completedCount],
                        backgroundColor: [
                            'rgba(0, 184, 148, 0.8)',
                            'rgba(253, 203, 110, 0.8)',
                            'rgba(116, 185, 255, 0.8)',
                            'rgba(253, 121, 168, 0.8)'
                        ],
                        borderColor: [
                            '#00b894',
                            '#fdcb6e',
                            '#74b9ff',
                            '#fd79a8'
                        ],
                        borderWidth: 2,
                        borderRadius: 10,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1,
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }

        // Load dashboard data on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardStats();
        });

        // Auto-refresh every 30 seconds
        setInterval(loadDashboardStats, 30000);
    </script>
</body>
</html>